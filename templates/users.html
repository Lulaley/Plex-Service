<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#313B45">
    <title>Liste des utilisateurs</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='images/plex-icon.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/users.css') }}">
</head>
<body>

    {% include 'navbar.html' %}

    <div class="users-wrapper">
        <div class="users-header">
            <h1>üë• Gestion des Utilisateurs</h1>
            <p class="subtitle">G√©rez les droits et les acc√®s de vos utilisateurs</p>
        </div>

        <div class="users-table-card">
            <div class="table-responsive">
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>Nom d'utilisateur</th>
                            <th>Email</th>
                            <th>Statut</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                        <tr>
                            <td data-label="Nom d'utilisateur"><span class="username">{{ user.uid }}</span></td>
                            <td data-label="Email"><span class="email">{{ user.mail }}</span></td>
                            <td data-label="Statut">
                                {% if user.rightsAgreement == 'PlexService::SuperAdmin' %}
                                    <span class="status-badge super-admin">Super Admin</span>
                                {% elif user.rightsAgreement == 'PlexService::Admin' %}
                                    <span class="status-badge admin">Admin</span>
                                {% elif user.rightsAgreement == 'PlexService::User' %}
                                    <span class="status-badge user">Utilisateur</span>
                                {% else %}
                                    <span class="status-badge pending">En attente</span>
                                {% endif %}
                            </td>
                            <td data-label="Actions">
                                <div class="action-buttons">
                                    {% if not user.rightsAgreement %}
                                    <button class="btn btn-validate" onclick="validateUser('{{ user.uid }}')">‚úì Valider</button>
                                    {% endif %}
                                    {% if session.rights_agreement == 'PlexService::SuperAdmin' %}
                                        {% if user.rightsAgreement != 'PlexService::SuperAdmin' %}
                                        <button class="btn btn-delete" onclick="deleteUser('{{ user.uid }}')">üóë Supprimer</button>
                                        {% endif %}
                                        {% if user.rightsAgreement != 'PlexService::Admin' and user.rightsAgreement != 'PlexService::SuperAdmin' %}
                                        <button class="btn btn-admin" onclick="makeAdmin('{{ user.uid }}')">‚≠ê Admin</button>
                                        {% endif %}
                                    {% elif session.rights_agreement == 'PlexService::Admin' %}
                                        {% if user.rightsAgreement == 'PlexService::User' %}
                                        <button class="btn btn-delete" onclick="deleteUser('{{ user.uid }}')">üóë Supprimer</button>
                                        {% endif %}
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/users.js') }}"></script>
</body>
</html>